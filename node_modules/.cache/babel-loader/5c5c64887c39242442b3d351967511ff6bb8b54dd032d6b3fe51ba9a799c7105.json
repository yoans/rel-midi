{"ast":null,"code":"var _jsxFileName = \"C:\\\\bench\\\\rel-midi\\\\src\\\\components\\\\Keyboard.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst NOTE_NAMES = ['C', 'C♯', 'D', 'D♯', 'E', 'F', 'F♯', 'G', 'G♯', 'A', 'A♯', 'B'];\nconst getNoteName = midi => `${NOTE_NAMES[midi % 12]}${Math.floor(midi / 12) - 1}`;\nconst isBlackKey = note => {\n  const n = note % 12;\n  return n === 1 || n === 3 || n === 6 || n === 8 || n === 10;\n};\nconst KEY_INTERVALS = {\n  'A': -4,\n  'S': -3,\n  'D': -2,\n  'F': -1,\n  '⎵': 0,\n  'J': 1,\n  'K': 2,\n  'L': 3,\n  ';': 4\n};\nconst Keyboard = ({\n  activeNotes,\n  onNoteOn,\n  onNoteOff,\n  currentNote\n}) => {\n  _s();\n  const startNote = 36; // C2\n  const endNote = 96; // C7\n  const containerRef = useRef(null);\n  const currentKeyRef = useRef(null);\n\n  // Auto-scroll to keep current note centered\n  useEffect(() => {\n    if (currentKeyRef.current && containerRef.current) {\n      const container = containerRef.current;\n      const key = currentKeyRef.current;\n      const containerRect = container.getBoundingClientRect();\n      const keyRect = key.getBoundingClientRect();\n      const keyCenter = keyRect.left + keyRect.width / 2 - containerRect.left + container.scrollLeft;\n      const scrollTarget = keyCenter - containerRect.width / 2;\n      container.scrollTo({\n        left: scrollTarget,\n        behavior: 'smooth'\n      });\n    }\n  }, [currentNote]);\n\n  // Build overlay map: note → [{label, interval}]\n  const overlayMap = {};\n  if (currentNote !== undefined) {\n    Object.entries(KEY_INTERVALS).forEach(([label, interval]) => {\n      const target = currentNote + interval;\n      if (target >= startNote && target <= endNote) {\n        if (!overlayMap[target]) overlayMap[target] = [];\n        overlayMap[target].push({\n          label,\n          interval\n        });\n      }\n    });\n  }\n  const keys = [];\n  for (let i = startNote; i <= endNote; i++) {\n    keys.push({\n      note: i,\n      isBlack: isBlackKey(i),\n      noteName: getNoteName(i),\n      isC: i % 12 === 0,\n      overlays: overlayMap[i] || [],\n      isCurrent: i === currentNote,\n      isActive: activeNotes.includes(i)\n    });\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"keyboard-wrapper\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"keyboard-container\",\n      ref: containerRef,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"keyboard\",\n        children: keys.map(key => /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: key.isCurrent ? currentKeyRef : null,\n          className: ['key', key.isBlack ? 'black-key' : 'white-key', key.isActive ? 'active' : '', key.isCurrent ? 'anchor' : '', key.overlays.length > 0 ? 'has-overlay' : ''].filter(Boolean).join(' '),\n          onMouseDown: () => onNoteOn(key.note),\n          onMouseUp: () => onNoteOff(key.note),\n          onMouseLeave: () => key.isActive && onNoteOff(key.note),\n          onTouchStart: e => {\n            e.preventDefault();\n            onNoteOn(key.note);\n          },\n          onTouchEnd: e => {\n            e.preventDefault();\n            onNoteOff(key.note);\n          },\n          children: [key.overlays.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"key-overlays\",\n            children: key.overlays.map(({\n              label,\n              interval\n            }) => /*#__PURE__*/_jsxDEV(\"span\", {\n              className: `overlay-badge ${interval < 0 ? 'neg' : interval > 0 ? 'pos' : 'zero'}`,\n              children: label\n            }, label, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 41\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 33\n          }, this), key.isCurrent && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"anchor-marker\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 47\n          }, this), key.isC && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"note-label\",\n            children: key.noteName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 41\n          }, this)]\n        }, key.note, true, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 9\n  }, this);\n};\n_s(Keyboard, \"ghwheJQgOUS4rZtavFEvS/Fz9Yo=\");\n_c = Keyboard;\nexport default Keyboard;\nvar _c;\n$RefreshReg$(_c, \"Keyboard\");","map":{"version":3,"names":["React","useEffect","useRef","jsxDEV","_jsxDEV","NOTE_NAMES","getNoteName","midi","Math","floor","isBlackKey","note","n","KEY_INTERVALS","Keyboard","activeNotes","onNoteOn","onNoteOff","currentNote","_s","startNote","endNote","containerRef","currentKeyRef","current","container","key","containerRect","getBoundingClientRect","keyRect","keyCenter","left","width","scrollLeft","scrollTarget","scrollTo","behavior","overlayMap","undefined","Object","entries","forEach","label","interval","target","push","keys","i","isBlack","noteName","isC","overlays","isCurrent","isActive","includes","className","children","ref","map","length","filter","Boolean","join","onMouseDown","onMouseUp","onMouseLeave","onTouchStart","e","preventDefault","onTouchEnd","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/bench/rel-midi/src/components/Keyboard.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\n\r\nconst NOTE_NAMES = ['C', 'C♯', 'D', 'D♯', 'E', 'F', 'F♯', 'G', 'G♯', 'A', 'A♯', 'B'];\r\nconst getNoteName = (midi) => `${NOTE_NAMES[midi % 12]}${Math.floor(midi / 12) - 1}`;\r\n\r\nconst isBlackKey = (note) => {\r\n    const n = note % 12;\r\n    return n === 1 || n === 3 || n === 6 || n === 8 || n === 10;\r\n};\r\n\r\nconst KEY_INTERVALS = {\r\n    'A': -4, 'S': -3, 'D': -2, 'F': -1,\r\n    '⎵': 0,\r\n    'J': 1, 'K': 2, 'L': 3, ';': 4,\r\n};\r\n\r\nconst Keyboard = ({ activeNotes, onNoteOn, onNoteOff, currentNote }) => {\r\n    const startNote = 36; // C2\r\n    const endNote = 96;   // C7\r\n    const containerRef = useRef(null);\r\n    const currentKeyRef = useRef(null);\r\n\r\n    // Auto-scroll to keep current note centered\r\n    useEffect(() => {\r\n        if (currentKeyRef.current && containerRef.current) {\r\n            const container = containerRef.current;\r\n            const key = currentKeyRef.current;\r\n            const containerRect = container.getBoundingClientRect();\r\n            const keyRect = key.getBoundingClientRect();\r\n\r\n            const keyCenter = keyRect.left + keyRect.width / 2 - containerRect.left + container.scrollLeft;\r\n            const scrollTarget = keyCenter - containerRect.width / 2;\r\n\r\n            container.scrollTo({ left: scrollTarget, behavior: 'smooth' });\r\n        }\r\n    }, [currentNote]);\r\n\r\n    // Build overlay map: note → [{label, interval}]\r\n    const overlayMap = {};\r\n    if (currentNote !== undefined) {\r\n        Object.entries(KEY_INTERVALS).forEach(([label, interval]) => {\r\n            const target = currentNote + interval;\r\n            if (target >= startNote && target <= endNote) {\r\n                if (!overlayMap[target]) overlayMap[target] = [];\r\n                overlayMap[target].push({ label, interval });\r\n            }\r\n        });\r\n    }\r\n\r\n    const keys = [];\r\n    for (let i = startNote; i <= endNote; i++) {\r\n        keys.push({\r\n            note: i,\r\n            isBlack: isBlackKey(i),\r\n            noteName: getNoteName(i),\r\n            isC: i % 12 === 0,\r\n            overlays: overlayMap[i] || [],\r\n            isCurrent: i === currentNote,\r\n            isActive: activeNotes.includes(i),\r\n        });\r\n    }\r\n\r\n    return (\r\n        <div className=\"keyboard-wrapper\">\r\n            <div className=\"keyboard-container\" ref={containerRef}>\r\n                <div className=\"keyboard\">\r\n                    {keys.map((key) => (\r\n                        <div\r\n                            key={key.note}\r\n                            ref={key.isCurrent ? currentKeyRef : null}\r\n                            className={[\r\n                                'key',\r\n                                key.isBlack ? 'black-key' : 'white-key',\r\n                                key.isActive ? 'active' : '',\r\n                                key.isCurrent ? 'anchor' : '',\r\n                                key.overlays.length > 0 ? 'has-overlay' : '',\r\n                            ].filter(Boolean).join(' ')}\r\n                            onMouseDown={() => onNoteOn(key.note)}\r\n                            onMouseUp={() => onNoteOff(key.note)}\r\n                            onMouseLeave={() => key.isActive && onNoteOff(key.note)}\r\n                            onTouchStart={(e) => { e.preventDefault(); onNoteOn(key.note); }}\r\n                            onTouchEnd={(e) => { e.preventDefault(); onNoteOff(key.note); }}\r\n                        >\r\n                            {key.overlays.length > 0 && (\r\n                                <div className=\"key-overlays\">\r\n                                    {key.overlays.map(({ label, interval }) => (\r\n                                        <span\r\n                                            key={label}\r\n                                            className={`overlay-badge ${interval < 0 ? 'neg' : interval > 0 ? 'pos' : 'zero'}`}\r\n                                        >\r\n                                            {label}\r\n                                        </span>\r\n                                    ))}\r\n                                </div>\r\n                            )}\r\n                            {key.isCurrent && <div className=\"anchor-marker\" />}\r\n                            {key.isC && <span className=\"note-label\">{key.noteName}</span>}\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Keyboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}