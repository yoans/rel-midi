{"ast":null,"code":"import React,{useState,useEffect,useCallback,useRef}from'react';import{useSynth}from'./SynthEngine';import Keyboard from'./components/Keyboard';import Controls from'./components/Controls';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NOTE_NAMES=['C','C♯','D','D♯','E','F','F♯','G','G♯','A','A♯','B'];const getNoteName=midi=>`${NOTE_NAMES[midi%12]}${Math.floor(midi/12)-1}`;const KEY_MAP={'a':-4,'s':-3,'d':-2,'f':-1,' ':0,'j':1,'k':2,'l':3,';':4};const KEY_LABELS=[{key:'A',interval:-4},{key:'S',interval:-3},{key:'D',interval:-2},{key:'F',interval:-1},{key:'SPACE',interval:0,isSpace:true},{key:'J',interval:+1},{key:'K',interval:+2},{key:'L',interval:+3},{key:';',interval:+4}];function MidiController(){const{playNote,stopNote,settings,updateSetting}=useSynth();const[midiOutputs,setMidiOutputs]=useState([]);const[selectedOutput,setSelectedOutput]=useState(null);const[currentNote,setCurrentNote]=useState(60);const[activeNotes,setActiveNotes]=useState([]);const[noteHistory,setNoteHistory]=useState([{note:60,time:Date.now()}]);const[pressedKey,setPressedKey]=useState(null);const[lastInterval,setLastInterval]=useState(null);const[showControls,setShowControls]=useState(false);const currentNoteRef=useRef(60);useEffect(()=>{currentNoteRef.current=currentNote;},[currentNote]);// MIDI Access\nuseEffect(()=>{const getMIDIAccess=async()=>{try{const access=await navigator.requestMIDIAccess();const outputs=Array.from(access.outputs.values());setMidiOutputs(outputs);if(outputs.length>0)setSelectedOutput(outputs[0].id);}catch(err){console.warn('MIDI access not available:',err);}};getMIDIAccess();},[]);const triggerNote=useCallback(function(note){let velocity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:100;setActiveNotes([note]);playNote(note);if(selectedOutput){navigator.requestMIDIAccess().then(access=>{const output=access.outputs.get(selectedOutput);if(output){output.send([0x90,note,velocity]);setTimeout(()=>{output.send([0x80,note,0]);stopNote(note);setActiveNotes([]);},400);}});}else{setTimeout(()=>{stopNote(note);setActiveNotes([]);},400);}},[playNote,stopNote,selectedOutput]);// Keyboard handler\nuseEffect(()=>{const handleKeyDown=e=>{if(e.repeat)return;const interval=KEY_MAP[e.key.toLowerCase()];if(interval!==undefined){e.preventDefault();const label=e.key===' '?'SPACE':e.key.toUpperCase();setPressedKey(label);setLastInterval(interval);const newNote=Math.max(0,Math.min(127,currentNoteRef.current+interval));setCurrentNote(newNote);setNoteHistory(prev=>[...prev.slice(-15),{note:newNote,time:Date.now()}]);triggerNote(newNote);}};const handleKeyUp=e=>{const interval=KEY_MAP[e.key.toLowerCase()];if(interval!==undefined){setPressedKey(null);}};window.addEventListener('keydown',handleKeyDown);window.addEventListener('keyup',handleKeyUp);return()=>{window.removeEventListener('keydown',handleKeyDown);window.removeEventListener('keyup',handleKeyUp);};},[triggerNote]);const handleVisualKeyClick=note=>{const interval=note-currentNote;setLastInterval(interval);setCurrentNote(note);setNoteHistory(prev=>[...prev.slice(-15),{note,time:Date.now()}]);triggerNote(note);};const jumpOctave=direction=>{const newNote=Math.max(0,Math.min(127,currentNote+direction*12));setCurrentNote(newNote);setLastInterval(direction*12);setNoteHistory(prev=>[...prev.slice(-15),{note:newNote,time:Date.now()}]);triggerNote(newNote);};return/*#__PURE__*/_jsxs(\"div\",{className:\"synth-container\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"synth-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"REL-MIDI\"}),/*#__PURE__*/_jsx(\"p\",{className:\"subtitle\",children:\"Relative Interval Controller\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"note-display\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"octave-btn\",onClick:()=>jumpOctave(-1),title:\"Octave Down\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"octave-arrow\",children:\"\\u25C2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"octave-label\",children:\"OCT\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"note-display-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"note-name\",children:getNoteName(currentNote)},currentNote),/*#__PURE__*/_jsxs(\"div\",{className:\"note-midi\",children:[\"MIDI \",currentNote]}),lastInterval!==null&&/*#__PURE__*/_jsx(\"div\",{className:`interval-indicator ${lastInterval>0?'pos':lastInterval<0?'neg':'zero'}`,children:lastInterval>0?`+${lastInterval}`:lastInterval===0?'●':lastInterval},`${lastInterval}-${Date.now()}`)]}),/*#__PURE__*/_jsxs(\"button\",{className:\"octave-btn\",onClick:()=>jumpOctave(1),title:\"Octave Up\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"octave-label\",children:\"OCT\"}),/*#__PURE__*/_jsx(\"span\",{className:\"octave-arrow\",children:\"\\u25B8\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"note-history\",children:noteHistory.map((entry,i)=>{const isCurrent=i===noteHistory.length-1;return/*#__PURE__*/_jsx(\"div\",{className:`history-note ${isCurrent?'current':''}`,style:{opacity:0.25+i/noteHistory.length*0.75},children:getNoteName(entry.note)},`${entry.time}-${i}`);})}),/*#__PURE__*/_jsx(\"div\",{className:\"key-hints-bar\",children:KEY_LABELS.map(_ref=>{let{key,interval,isSpace}=_ref;const targetNote=Math.max(0,Math.min(127,currentNote+interval));return/*#__PURE__*/_jsxs(\"div\",{className:['key-btn',isSpace?'space':'',interval<0?'neg':interval>0?'pos':'zero',pressedKey===key?'pressed':''].filter(Boolean).join(' '),children:[/*#__PURE__*/_jsx(\"span\",{className:\"key-cap\",children:key}),/*#__PURE__*/_jsx(\"span\",{className:\"key-interval\",children:interval>0?`+${interval}`:interval===0?'RPT':interval}),/*#__PURE__*/_jsx(\"span\",{className:\"key-target\",children:getNoteName(targetNote)})]},key);})}),/*#__PURE__*/_jsx(Keyboard,{activeNotes:activeNotes,onNoteOn:handleVisualKeyClick,onNoteOff:()=>{},currentNote:currentNote}),/*#__PURE__*/_jsx(\"button\",{className:\"controls-toggle\",onClick:()=>setShowControls(!showControls),children:showControls?'▾ Hide Synth Controls':'▸ Synth Controls'}),/*#__PURE__*/_jsx(\"div\",{className:`controls-wrapper ${showControls?'open':''}`,children:/*#__PURE__*/_jsx(Controls,{settings:settings,updateSetting:updateSetting,midiOutputs:midiOutputs,selectedOutput:selectedOutput,setSelectedOutput:setSelectedOutput})})]});}export default MidiController;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useSynth","Keyboard","Controls","jsx","_jsx","jsxs","_jsxs","NOTE_NAMES","getNoteName","midi","Math","floor","KEY_MAP","KEY_LABELS","key","interval","isSpace","MidiController","playNote","stopNote","settings","updateSetting","midiOutputs","setMidiOutputs","selectedOutput","setSelectedOutput","currentNote","setCurrentNote","activeNotes","setActiveNotes","noteHistory","setNoteHistory","note","time","Date","now","pressedKey","setPressedKey","lastInterval","setLastInterval","showControls","setShowControls","currentNoteRef","current","getMIDIAccess","access","navigator","requestMIDIAccess","outputs","Array","from","values","length","id","err","console","warn","triggerNote","velocity","arguments","undefined","then","output","get","send","setTimeout","handleKeyDown","e","repeat","toLowerCase","preventDefault","label","toUpperCase","newNote","max","min","prev","slice","handleKeyUp","window","addEventListener","removeEventListener","handleVisualKeyClick","jumpOctave","direction","className","children","onClick","title","map","entry","i","isCurrent","style","opacity","_ref","targetNote","filter","Boolean","join","onNoteOn","onNoteOff"],"sources":["C:/bench/rel-midi/src/MidiController.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { useSynth } from './SynthEngine';\r\nimport Keyboard from './components/Keyboard';\r\nimport Controls from './components/Controls';\r\n\r\nconst NOTE_NAMES = ['C', 'C♯', 'D', 'D♯', 'E', 'F', 'F♯', 'G', 'G♯', 'A', 'A♯', 'B'];\r\nconst getNoteName = (midi) => `${NOTE_NAMES[midi % 12]}${Math.floor(midi / 12) - 1}`;\r\n\r\nconst KEY_MAP = {\r\n  'a': -4, 's': -3, 'd': -2, 'f': -1,\r\n  ' ': 0,\r\n  'j': 1, 'k': 2, 'l': 3, ';': 4,\r\n};\r\n\r\nconst KEY_LABELS = [\r\n  { key: 'A', interval: -4 },\r\n  { key: 'S', interval: -3 },\r\n  { key: 'D', interval: -2 },\r\n  { key: 'F', interval: -1 },\r\n  { key: 'SPACE', interval: 0, isSpace: true },\r\n  { key: 'J', interval: +1 },\r\n  { key: 'K', interval: +2 },\r\n  { key: 'L', interval: +3 },\r\n  { key: ';', interval: +4 },\r\n];\r\n\r\nfunction MidiController() {\r\n  const { playNote, stopNote, settings, updateSetting } = useSynth();\r\n  const [midiOutputs, setMidiOutputs] = useState([]);\r\n  const [selectedOutput, setSelectedOutput] = useState(null);\r\n  const [currentNote, setCurrentNote] = useState(60);\r\n  const [activeNotes, setActiveNotes] = useState([]);\r\n  const [noteHistory, setNoteHistory] = useState([{ note: 60, time: Date.now() }]);\r\n  const [pressedKey, setPressedKey] = useState(null);\r\n  const [lastInterval, setLastInterval] = useState(null);\r\n  const [showControls, setShowControls] = useState(false);\r\n\r\n  const currentNoteRef = useRef(60);\r\n\r\n  useEffect(() => {\r\n    currentNoteRef.current = currentNote;\r\n  }, [currentNote]);\r\n\r\n  // MIDI Access\r\n  useEffect(() => {\r\n    const getMIDIAccess = async () => {\r\n      try {\r\n        const access = await navigator.requestMIDIAccess();\r\n        const outputs = Array.from(access.outputs.values());\r\n        setMidiOutputs(outputs);\r\n        if (outputs.length > 0) setSelectedOutput(outputs[0].id);\r\n      } catch (err) {\r\n        console.warn('MIDI access not available:', err);\r\n      }\r\n    };\r\n    getMIDIAccess();\r\n  }, []);\r\n\r\n  const triggerNote = useCallback((note, velocity = 100) => {\r\n    setActiveNotes([note]);\r\n    playNote(note);\r\n\r\n    if (selectedOutput) {\r\n      navigator.requestMIDIAccess().then(access => {\r\n        const output = access.outputs.get(selectedOutput);\r\n        if (output) {\r\n          output.send([0x90, note, velocity]);\r\n          setTimeout(() => {\r\n            output.send([0x80, note, 0]);\r\n            stopNote(note);\r\n            setActiveNotes([]);\r\n          }, 400);\r\n        }\r\n      });\r\n    } else {\r\n      setTimeout(() => {\r\n        stopNote(note);\r\n        setActiveNotes([]);\r\n      }, 400);\r\n    }\r\n  }, [playNote, stopNote, selectedOutput]);\r\n\r\n  // Keyboard handler\r\n  useEffect(() => {\r\n    const handleKeyDown = (e) => {\r\n      if (e.repeat) return;\r\n      const interval = KEY_MAP[e.key.toLowerCase()];\r\n      if (interval !== undefined) {\r\n        e.preventDefault();\r\n        const label = e.key === ' ' ? 'SPACE' : e.key.toUpperCase();\r\n        setPressedKey(label);\r\n        setLastInterval(interval);\r\n\r\n        const newNote = Math.max(0, Math.min(127, currentNoteRef.current + interval));\r\n        setCurrentNote(newNote);\r\n        setNoteHistory(prev => [...prev.slice(-15), { note: newNote, time: Date.now() }]);\r\n        triggerNote(newNote);\r\n      }\r\n    };\r\n\r\n    const handleKeyUp = (e) => {\r\n      const interval = KEY_MAP[e.key.toLowerCase()];\r\n      if (interval !== undefined) {\r\n        setPressedKey(null);\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    window.addEventListener('keyup', handleKeyUp);\r\n    return () => {\r\n      window.removeEventListener('keydown', handleKeyDown);\r\n      window.removeEventListener('keyup', handleKeyUp);\r\n    };\r\n  }, [triggerNote]);\r\n\r\n  const handleVisualKeyClick = (note) => {\r\n    const interval = note - currentNote;\r\n    setLastInterval(interval);\r\n    setCurrentNote(note);\r\n    setNoteHistory(prev => [...prev.slice(-15), { note, time: Date.now() }]);\r\n    triggerNote(note);\r\n  };\r\n\r\n  const jumpOctave = (direction) => {\r\n    const newNote = Math.max(0, Math.min(127, currentNote + direction * 12));\r\n    setCurrentNote(newNote);\r\n    setLastInterval(direction * 12);\r\n    setNoteHistory(prev => [...prev.slice(-15), { note: newNote, time: Date.now() }]);\r\n    triggerNote(newNote);\r\n  };\r\n\r\n  return (\r\n    <div className=\"synth-container\">\r\n      <header className=\"synth-header\">\r\n        <h1>REL-MIDI</h1>\r\n        <p className=\"subtitle\">Relative Interval Controller</p>\r\n      </header>\r\n\r\n      {/* Note Display */}\r\n      <div className=\"note-display\">\r\n        <button className=\"octave-btn\" onClick={() => jumpOctave(-1)} title=\"Octave Down\">\r\n          <span className=\"octave-arrow\">◂</span>\r\n          <span className=\"octave-label\">OCT</span>\r\n        </button>\r\n        <div className=\"note-display-center\">\r\n          <div className=\"note-name\" key={currentNote}>{getNoteName(currentNote)}</div>\r\n          <div className=\"note-midi\">MIDI {currentNote}</div>\r\n          {lastInterval !== null && (\r\n            <div\r\n              key={`${lastInterval}-${Date.now()}`}\r\n              className={`interval-indicator ${lastInterval > 0 ? 'pos' : lastInterval < 0 ? 'neg' : 'zero'}`}\r\n            >\r\n              {lastInterval > 0 ? `+${lastInterval}` : lastInterval === 0 ? '●' : lastInterval}\r\n            </div>\r\n          )}\r\n        </div>\r\n        <button className=\"octave-btn\" onClick={() => jumpOctave(1)} title=\"Octave Up\">\r\n          <span className=\"octave-label\">OCT</span>\r\n          <span className=\"octave-arrow\">▸</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Note History */}\r\n      <div className=\"note-history\">\r\n        {noteHistory.map((entry, i) => {\r\n          const isCurrent = i === noteHistory.length - 1;\r\n          return (\r\n            <div\r\n              key={`${entry.time}-${i}`}\r\n              className={`history-note ${isCurrent ? 'current' : ''}`}\r\n              style={{ opacity: 0.25 + (i / noteHistory.length) * 0.75 }}\r\n            >\r\n              {getNoteName(entry.note)}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {/* Key Hints */}\r\n      <div className=\"key-hints-bar\">\r\n        {KEY_LABELS.map(({ key, interval, isSpace }) => {\r\n          const targetNote = Math.max(0, Math.min(127, currentNote + interval));\r\n          return (\r\n            <div\r\n              key={key}\r\n              className={[\r\n                'key-btn',\r\n                isSpace ? 'space' : '',\r\n                interval < 0 ? 'neg' : interval > 0 ? 'pos' : 'zero',\r\n                pressedKey === key ? 'pressed' : '',\r\n              ].filter(Boolean).join(' ')}\r\n            >\r\n              <span className=\"key-cap\">{key}</span>\r\n              <span className=\"key-interval\">\r\n                {interval > 0 ? `+${interval}` : interval === 0 ? 'RPT' : interval}\r\n              </span>\r\n              <span className=\"key-target\">{getNoteName(targetNote)}</span>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      {/* Piano */}\r\n      <Keyboard\r\n        activeNotes={activeNotes}\r\n        onNoteOn={handleVisualKeyClick}\r\n        onNoteOff={() => {}}\r\n        currentNote={currentNote}\r\n      />\r\n\r\n      {/* Collapsible Controls */}\r\n      <button\r\n        className=\"controls-toggle\"\r\n        onClick={() => setShowControls(!showControls)}\r\n      >\r\n        {showControls ? '▾ Hide Synth Controls' : '▸ Synth Controls'}\r\n      </button>\r\n      <div className={`controls-wrapper ${showControls ? 'open' : ''}`}>\r\n        <Controls\r\n          settings={settings}\r\n          updateSetting={updateSetting}\r\n          midiOutputs={midiOutputs}\r\n          selectedOutput={selectedOutput}\r\n          setSelectedOutput={setSelectedOutput}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MidiController;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}