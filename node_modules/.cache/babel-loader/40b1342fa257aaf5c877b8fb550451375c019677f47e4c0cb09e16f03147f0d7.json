{"ast":null,"code":"var _jsxFileName = \"C:\\\\bench\\\\rel-midi\\\\src\\\\MidiController.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useSynth } from './SynthEngine';\nimport Keyboard from './components/Keyboard';\nimport Controls from './components/Controls';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction MidiController() {\n  _s();\n  const {\n    playNote,\n    stopNote,\n    settings,\n    updateSetting\n  } = useSynth();\n  const [midiOutputs, setMidiOutputs] = useState([]);\n  const [selectedOutput, setSelectedOutput] = useState(null);\n  const [activeNotes, setActiveNotes] = useState([]);\n\n  // MIDI Access Initialization\n  useEffect(() => {\n    const getMIDIAccess = async () => {\n      try {\n        const access = await navigator.requestMIDIAccess();\n        const outputs = Array.from(access.outputs.values());\n        setMidiOutputs(outputs);\n        if (outputs.length > 0) {\n          setSelectedOutput(outputs[0].id);\n        }\n      } catch (err) {\n        console.warn('MIDI access not available:', err);\n      }\n    };\n    getMIDIAccess();\n  }, []);\n\n  // Handle Note On\n  const handleNoteOn = useCallback(note => {\n    if (!activeNotes.includes(note)) {\n      setActiveNotes(prev => [...prev, note]);\n\n      // Play internal synth\n      playNote(note);\n\n      // Send MIDI if output selected\n      if (selectedOutput) {\n        navigator.requestMIDIAccess().then(access => {\n          const output = access.outputs.get(selectedOutput);\n          if (output) {\n            output.send([0x90, note, 100]);\n          }\n        });\n      }\n    }\n  }, [activeNotes, playNote, selectedOutput]);\n\n  // Handle Note Off\n  const handleNoteOff = useCallback(note => {\n    setActiveNotes(prev => prev.filter(n => n !== note));\n\n    // Stop internal synth\n    stopNote(note);\n\n    // Send MIDI off\n    if (selectedOutput) {\n      navigator.requestMIDIAccess().then(access => {\n        const output = access.outputs.get(selectedOutput);\n        if (output) {\n          output.send([0x80, note, 0]);\n        }\n      });\n    }\n  }, [stopNote, selectedOutput]);\n\n  // Keyboard Support\n  useEffect(() => {\n    const keyMap = {\n      'a': 60,\n      'w': 61,\n      's': 62,\n      'e': 63,\n      'd': 64,\n      'f': 65,\n      't': 66,\n      'g': 67,\n      'y': 68,\n      'h': 69,\n      'u': 70,\n      'j': 71,\n      'k': 72,\n      'o': 73,\n      'l': 74,\n      'p': 75,\n      ';': 76,\n      \"'\": 77\n    };\n    const handleKeyDown = e => {\n      if (e.repeat) return;\n      const note = keyMap[e.key.toLowerCase()];\n      if (note) handleNoteOn(note);\n    };\n    const handleKeyUp = e => {\n      const note = keyMap[e.key.toLowerCase()];\n      if (note) handleNoteOff(note);\n    };\n    window.addEventListener('keydown', handleKeyDown);\n    window.addEventListener('keyup', handleKeyUp);\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown);\n      window.removeEventListener('keyup', handleKeyUp);\n    };\n  }, [handleNoteOn, handleNoteOff]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"synth-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Neon Synth\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Controls, {\n      settings: settings,\n      updateSetting: updateSetting,\n      midiOutputs: midiOutputs,\n      selectedOutput: selectedOutput,\n      setSelectedOutput: setSelectedOutput\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Keyboard, {\n      activeNotes: activeNotes,\n      onNoteOn: handleNoteOn,\n      onNoteOff: handleNoteOff\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 5\n  }, this);\n}\n_s(MidiController, \"fZbmJ8za9lQA13xvnAxvkgV2GHA=\", false, function () {\n  return [useSynth];\n});\n_c = MidiController;\nexport default MidiController;\nvar _c;\n$RefreshReg$(_c, \"MidiController\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useSynth","Keyboard","Controls","jsxDEV","_jsxDEV","MidiController","_s","playNote","stopNote","settings","updateSetting","midiOutputs","setMidiOutputs","selectedOutput","setSelectedOutput","activeNotes","setActiveNotes","getMIDIAccess","access","navigator","requestMIDIAccess","outputs","Array","from","values","length","id","err","console","warn","handleNoteOn","note","includes","prev","then","output","get","send","handleNoteOff","filter","n","keyMap","handleKeyDown","e","repeat","key","toLowerCase","handleKeyUp","window","addEventListener","removeEventListener","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onNoteOn","onNoteOff","_c","$RefreshReg$"],"sources":["C:/bench/rel-midi/src/MidiController.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useSynth } from './SynthEngine';\r\nimport Keyboard from './components/Keyboard';\r\nimport Controls from './components/Controls';\r\n\r\nfunction MidiController() {\r\n  const { playNote, stopNote, settings, updateSetting } = useSynth();\r\n  const [midiOutputs, setMidiOutputs] = useState([]);\r\n  const [selectedOutput, setSelectedOutput] = useState(null);\r\n  const [activeNotes, setActiveNotes] = useState([]);\r\n\r\n  // MIDI Access Initialization\r\n  useEffect(() => {\r\n    const getMIDIAccess = async () => {\r\n      try {\r\n        const access = await navigator.requestMIDIAccess();\r\n        const outputs = Array.from(access.outputs.values());\r\n        setMidiOutputs(outputs);\r\n        if (outputs.length > 0) {\r\n          setSelectedOutput(outputs[0].id);\r\n        }\r\n      } catch (err) {\r\n        console.warn('MIDI access not available:', err);\r\n      }\r\n    };\r\n    getMIDIAccess();\r\n  }, []);\r\n\r\n  // Handle Note On\r\n  const handleNoteOn = useCallback((note) => {\r\n    if (!activeNotes.includes(note)) {\r\n      setActiveNotes(prev => [...prev, note]);\r\n\r\n      // Play internal synth\r\n      playNote(note);\r\n\r\n      // Send MIDI if output selected\r\n      if (selectedOutput) {\r\n        navigator.requestMIDIAccess().then(access => {\r\n          const output = access.outputs.get(selectedOutput);\r\n          if (output) {\r\n            output.send([0x90, note, 100]);\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }, [activeNotes, playNote, selectedOutput]);\r\n\r\n  // Handle Note Off\r\n  const handleNoteOff = useCallback((note) => {\r\n    setActiveNotes(prev => prev.filter(n => n !== note));\r\n\r\n    // Stop internal synth\r\n    stopNote(note);\r\n\r\n    // Send MIDI off\r\n    if (selectedOutput) {\r\n      navigator.requestMIDIAccess().then(access => {\r\n        const output = access.outputs.get(selectedOutput);\r\n        if (output) {\r\n          output.send([0x80, note, 0]);\r\n        }\r\n      });\r\n    }\r\n  }, [stopNote, selectedOutput]);\r\n\r\n  // Keyboard Support\r\n  useEffect(() => {\r\n    const keyMap = {\r\n      'a': 60, 'w': 61, 's': 62, 'e': 63, 'd': 64, 'f': 65, 't': 66,\r\n      'g': 67, 'y': 68, 'h': 69, 'u': 70, 'j': 71, 'k': 72, 'o': 73,\r\n      'l': 74, 'p': 75, ';': 76, \"'\": 77\r\n    };\r\n\r\n    const handleKeyDown = (e) => {\r\n      if (e.repeat) return;\r\n      const note = keyMap[e.key.toLowerCase()];\r\n      if (note) handleNoteOn(note);\r\n    };\r\n\r\n    const handleKeyUp = (e) => {\r\n      const note = keyMap[e.key.toLowerCase()];\r\n      if (note) handleNoteOff(note);\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    window.addEventListener('keyup', handleKeyUp);\r\n\r\n    return () => {\r\n      window.removeEventListener('keydown', handleKeyDown);\r\n      window.removeEventListener('keyup', handleKeyUp);\r\n    };\r\n  }, [handleNoteOn, handleNoteOff]);\r\n\r\n  return (\r\n    <div className=\"synth-container\">\r\n      <h1>Neon Synth</h1>\r\n\r\n      <Controls\r\n        settings={settings}\r\n        updateSetting={updateSetting}\r\n        midiOutputs={midiOutputs}\r\n        selectedOutput={selectedOutput}\r\n        setSelectedOutput={setSelectedOutput}\r\n      />\r\n\r\n      <Keyboard\r\n        activeNotes={activeNotes}\r\n        onNoteOn={handleNoteOn}\r\n        onNoteOff={handleNoteOff}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MidiController;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}